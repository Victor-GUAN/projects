(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25942,        662]
NotebookOptionsPosition[     25188,        635]
NotebookOutlinePosition[     25564,        651]
CellTagsIndexPosition[     25521,        648]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Falling of pen on table(curve)", "Title",
 CellChangeTimes->{{3.7159587083406067`*^9, 3.7159587173721*^9}, {
  3.7159638319174232`*^9, 3.715963832515299*^9}, {3.716575996513005*^9, 
  3.7165760079540205`*^9}},
 ExpressionUUID -> "3d0d802b-0836-4aef-85f1-8b410b652501"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7165759460264964`*^9, 3.7165759675265846`*^9}, {
  3.7166090176566534`*^9, 3.7166090274603896`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "functions", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"c1hs", "[", 
     RowBox[{"x_", ",", "scale_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Tanh", "[", 
        RowBox[{"x", "/", "scale"}], "]"}], "+", "1"}], ")"}], "/", "2"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curve", "[", "x_", "]"}], ":=", 
    RowBox[{
     RowBox[{"h", "/", "3"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", "x"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tgv", "[", 
     RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Normalize", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"f", "'"}], "[", "x", "]"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nmv", "[", 
     RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Normalize", "[", 
     RowBox[{
      RowBox[{"RotationMatrix", "[", 
       RowBox[{"Pi", "/", "2"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"f", "'"}], "[", "x", "]"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7165656992391596`*^9, 3.716565765570979*^9}, {
   3.716567700595288*^9, 3.7165677508792596`*^9}, 3.7165679301656795`*^9, {
   3.7165679886504574`*^9, 3.7165680176412635`*^9}, {3.716568409313828*^9, 
   3.716568444530252*^9}, 3.7165684754877424`*^9, {3.7165686436089473`*^9, 
   3.7165686888395915`*^9}, {3.71656872076887*^9, 3.71656876925569*^9}, {
   3.7165688256998215`*^9, 3.716568837156217*^9}, {3.7165690795674047`*^9, 
   3.7165690819545927`*^9}, {3.7165692638208513`*^9, 3.716569265369851*^9}, 
   3.7165693748314238`*^9, {3.7165694311565104`*^9, 3.7165694468779135`*^9}, 
   3.7165695104196696`*^9, {3.716569652282749*^9, 3.716569675166752*^9}, {
   3.71657168974232*^9, 3.7165717005468645`*^9}, {3.716571772242489*^9, 
   3.716571790726894*^9}, {3.7165756267272973`*^9, 3.71657562976213*^9}, 
   3.7166144261844006`*^9, {3.7166320286415234`*^9, 3.716632039739385*^9}, {
   3.7166321285562415`*^9, 3.716632142124702*^9}, 3.7166321847852125`*^9, {
   3.7166322291571913`*^9, 3.7166322298943653`*^9}, {3.7166322690371876`*^9, 
   3.7166322695667205`*^9}, {3.716632500066016*^9, 3.7166325173208866`*^9}},
 ExpressionUUID -> "a6bb186f-9e34-49ca-9fc2-399799027d93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tend", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", "=", "0.2"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"pen", " ", "mass"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "=", "0.005"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"pen", " ", "radius"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h", "=", "0.1"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"pen", " ", "length"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scalt", "=", "0.00001"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"detect", " ", "contact", " ", "activation", " ", "time"}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"{", 
    RowBox[{"(*", "gravity", "*)"}], 
    RowBox[{
     RowBox[{"g", "\[Rule]", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"inertia", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Jzz", "->", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", "m", " ", 
       RowBox[{"R", "^", "2"}]}]}], ",", 
     RowBox[{"Jxx", "->", " ", 
      RowBox[{
       RowBox[{"m", "/", "4"}], " ", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"R", "^", "2"}], "+", 
         RowBox[{
          RowBox[{"h", "^", "2"}], "/", "3"}]}], ")"}]}]}], ",", 
     RowBox[{"Jyy", "->", " ", 
      RowBox[{
       RowBox[{"m", "/", "4"}], " ", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"R", "^", "2"}], "+", 
         RowBox[{
          RowBox[{"h", "^", "2"}], "/", "3"}]}], ")"}]}]}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"contact", " ", "and", " ", "sliding", " ", "stiffness"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"kz", "\[Rule]", 
      RowBox[{"5", " ", 
       RowBox[{"10", "^", "4"}]}]}], ",", 
     RowBox[{"\[Mu]x", "\[Rule]", ".05"}]}], " ", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.715936342399261*^9, 3.715936369689273*^9}, 
   3.7159441110634193`*^9, {3.715957881690446*^9, 3.715957895487862*^9}, 
   3.715957977478826*^9, 3.715958376809407*^9, 3.715958520347474*^9, 
   3.715958574602921*^9, 3.7159588073664417`*^9, 3.7159591048337*^9, 
   3.715959135872903*^9, 3.715960676432487*^9, {3.715960735958639*^9, 
   3.715960738996554*^9}, {3.715960790652705*^9, 3.715960807290556*^9}, {
   3.715961432295598*^9, 3.715961432653781*^9}, {3.715962004292397*^9, 
   3.7159620049546547`*^9}, {3.715962121840373*^9, 3.715962129558261*^9}, 
   3.71596354549507*^9, {3.715963705291177*^9, 3.715963823924645*^9}, {
   3.7159646067057543`*^9, 3.7159646079392157`*^9}, 3.7159646715311527`*^9, 
   3.715964752248114*^9, {3.71596500664065*^9, 3.7159650098086*^9}},
 ExpressionUUID -> "ff64916d-2af7-4025-ae1f-203b9fbd92f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"inertia", " ", "center"}], " ", "&"}], " ", "front", " ", "and",
     " ", "rear", " ", "ends", " ", "of", " ", "pen"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xC", "[", "t_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xCx", "[", "t", "]"}], ",", 
      RowBox[{"xCz", "[", "t", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xSf", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"xC", "[", "t", "]"}], "+", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", " ", 
        RowBox[{"2", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"RotationMatrix", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "h"}]}], "}"}]}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xSr", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"xC", "[", "t", "]"}], "+", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", " ", 
        RowBox[{"2", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], " ", 
      RowBox[{
       RowBox[{"RotationMatrix", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "h"}], "}"}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.715936075184609*^9, 3.715936093418707*^9}, {
  3.715936590897797*^9, 3.715936596481655*^9}, {3.71595882044221*^9, 
  3.7159588287689037`*^9}, {3.7159588759604588`*^9, 3.715958899470537*^9}, {
  3.7165572202681103`*^9, 3.7165572229872265`*^9}, {3.7166155925662775`*^9, 
  3.7166156117017317`*^9}},
 ExpressionUUID -> "0b90855f-ee0e-4b2c-8887-8f1bdd0795b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "velocity", " ", "in", " ", "the", " ", "tangent", " ", "direction", " ", 
    "of", " ", "the", " ", "curve"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vSftg", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"xSf", "'"}], "[", "t", "]"}], ".", 
     RowBox[{"tgv", "[", 
      RowBox[{"curve", ",", 
       RowBox[{
        RowBox[{"xSf", "[", "t", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vSrtg", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"xSr", "'"}], "[", "t", "]"}], ".", 
     RowBox[{"tgv", "[", 
      RowBox[{"curve", ",", 
       RowBox[{
        RowBox[{"xSr", "[", "t", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"depth", " ", "in", " ", "the", " ", "curve", " ", "table"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dSf", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"xSf", "[", "t", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"curve", "[", 
         RowBox[{
          RowBox[{"xSf", "[", "t", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "}"}], ".", 
     RowBox[{"nmv", "[", 
      RowBox[{"curve", ",", 
       RowBox[{
        RowBox[{"xSf", "[", "t", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dSr", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"xSr", "[", "t", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"curve", "[", 
         RowBox[{
          RowBox[{"xSr", "[", "t", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "}"}], ".", 
     RowBox[{"nmv", "[", 
      RowBox[{"curve", ",", 
       RowBox[{
        RowBox[{"xSr", "[", "t", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.716570028658888*^9, 3.7165702026367025`*^9}, {
  3.716570247640074*^9, 3.71657034805231*^9}, {3.7165708595747523`*^9, 
  3.716571083873165*^9}, {3.7165711192902308`*^9, 3.716571148761695*^9}, {
  3.7165713080171432`*^9, 3.71657131116881*^9}, {3.716614359682893*^9, 
  3.71661437456398*^9}, {3.716614436709213*^9, 3.716614451994199*^9}, {
  3.716615090140587*^9, 3.716615093604787*^9}, {3.716615319389415*^9, 
  3.7166153556584067`*^9}, {3.7166156364503655`*^9, 3.7166156600671124`*^9}, {
  3.7166303115613775`*^9, 3.716630312730908*^9}, {3.716630455588375*^9, 
  3.7166304563488283`*^9}, {3.716631146218502*^9, 3.716631223467678*^9}, {
  3.7166312829100313`*^9, 3.7166312989172225`*^9}, {3.716631640375886*^9, 
  3.716631656764887*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"contact", " ", "forces", " ", 
     RowBox[{"against", " ", "@", "z"}]}], "=", 
    RowBox[{
    "0", " ", "at", " ", "both", " ", "ends", " ", "of", " ", "pen"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"c1hs", "[", "...", "]"}], " ", "is", " ", "for", " ", "purpose", 
    " ", "of", " ", "determining", " ", "whether", " ", 
    RowBox[{"there", "'"}], "s", " ", "contact", " ", "forces"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fSf", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Mu]x"}], " ", 
       RowBox[{"c1hs", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"curve", "[", 
           RowBox[{
            RowBox[{"xSf", "[", "t", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"xSf", "[", "t", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "scalt"}], "]"}], 
       RowBox[{"vSftg", "[", "t", "]"}], 
       RowBox[{"tgv", "[", 
        RowBox[{"curve", ",", 
         RowBox[{
          RowBox[{"xSf", "[", "t", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "-", 
      RowBox[{"kz", " ", 
       RowBox[{"c1hs", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"curve", "[", 
           RowBox[{
            RowBox[{"xSf", "[", "t", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"xSf", "[", "t", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "scalt"}], "]"}], 
       RowBox[{"dSf", "[", "t", "]"}], 
       RowBox[{"nmv", "[", 
        RowBox[{"curve", ",", 
         RowBox[{
          RowBox[{"xSf", "[", "t", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fSr", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Mu]x"}], " ", 
       RowBox[{"c1hs", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"curve", "[", 
           RowBox[{
            RowBox[{"xSr", "[", "t", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"xSr", "[", "t", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "scalt"}], "]"}], 
       RowBox[{"vSrtg", "[", "t", "]"}], 
       RowBox[{"tgv", "[", 
        RowBox[{"curve", ",", 
         RowBox[{
          RowBox[{"xSr", "[", "t", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "-", 
      RowBox[{"kz", " ", 
       RowBox[{"c1hs", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"curve", "[", 
           RowBox[{
            RowBox[{"xSr", "[", "t", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"xSr", "[", "t", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "scalt"}], "]"}], 
       RowBox[{"dSr", "[", "t", "]"}], 
       RowBox[{"nmv", "[", 
        RowBox[{"curve", ",", 
         RowBox[{
          RowBox[{"xSr", "[", "t", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7159364598439007`*^9, 3.715936465101759*^9}, {
   3.715936513900465*^9, 3.715936515036323*^9}, {3.715936835354702*^9, 
   3.715936836473525*^9}, {3.715937930614933*^9, 3.7159380438007507`*^9}, 
   3.715938182045574*^9, {3.715938503403036*^9, 3.71593851081719*^9}, {
   3.71594107786861*^9, 3.715941136368807*^9}, {3.715943634748308*^9, 
   3.715943662963456*^9}, 3.715943719034122*^9, {3.715957861699041*^9, 
   3.715957877240941*^9}, {3.7159579121533813`*^9, 3.715957949209332*^9}, {
   3.71595883292178*^9, 3.7159588602006283`*^9}, {3.715960521213945*^9, 
   3.715960525635982*^9}, {3.715960587178481*^9, 3.7159606286322927`*^9}, {
   3.715964619803872*^9, 3.715964629802389*^9}, {3.715964977057191*^9, 
   3.715965027677682*^9}, {3.7165704076465607`*^9, 3.7165704271411967`*^9}, {
   3.71657054019948*^9, 3.7165705895372086`*^9}, {3.716570625186726*^9, 
   3.716570731141822*^9}, {3.716570761762847*^9, 3.7165708119202805`*^9}, {
   3.7165711910427823`*^9, 3.716571250868681*^9}, {3.7165713009280434`*^9, 
   3.716571325071735*^9}, {3.716571414200369*^9, 3.716571469373258*^9}, {
   3.7166144792521544`*^9, 3.7166145178416595`*^9}, {3.7166150154005365`*^9, 
   3.7166150203549647`*^9}, {3.716615105312566*^9, 3.71661510884783*^9}, {
   3.7166152639554987`*^9, 3.716615293375102*^9}, {3.716630350390066*^9, 
   3.716630358949342*^9}, {3.7166305012343855`*^9, 3.716630508171358*^9}, {
   3.7166306808641353`*^9, 3.7166307086051188`*^9}, {3.7166309615124145`*^9, 
   3.71663097018782*^9}, {3.716631401662041*^9, 3.7166314859834485`*^9}, 
   3.7166315481417356`*^9, {3.7166315814416757`*^9, 3.716631614021387*^9}, {
   3.716631660192378*^9, 3.716631760963639*^9}},
 ExpressionUUID -> "66081c83-fa08-4c27-bd20-95056156fb3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqNewton", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"m", " ", 
       RowBox[{
        RowBox[{"xC", "''"}], "[", "t", "]"}]}], "+", 
      RowBox[{"0.01", " ", "m", " ", 
       RowBox[{
        RowBox[{"xC", "'"}], "[", "t", "]"}]}]}], " ", "\[Equal]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "m"}], " ", "g", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], " ", "+", " ", 
      RowBox[{"fSf", "[", "t", "]"}], "+", " ", 
      RowBox[{"fSr", "[", "t", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqEuler", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Jxx", " ", 
      RowBox[{
       RowBox[{"\[Theta]", "''"}], "[", "t", "]"}]}], "+", 
     RowBox[{"0.01", " ", "Jxx", " ", 
      RowBox[{
       RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"xSf", "[", "t", "]"}], "-", 
         RowBox[{"xC", "[", "t", "]"}]}], ",", 
        RowBox[{"fSf", "[", "t", "]"}]}], "}"}], "]"}], "+", 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"xSr", "[", "t", "]"}], "-", 
         RowBox[{"xC", "[", "t", "]"}]}], ",", 
        RowBox[{"fSr", "[", "t", "]"}]}], "}"}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.715936409989621*^9, 3.715936455310384*^9}, {
   3.715936506580739*^9, 3.715936586355569*^9}, {3.7159368043787413`*^9, 
   3.715936831929879*^9}, {3.7159381326379557`*^9, 3.715938133477994*^9}, {
   3.7159385785929337`*^9, 3.715938591902149*^9}, {3.715938759545211*^9, 
   3.715938770576602*^9}, {3.7159389881321907`*^9, 3.71593899380926*^9}, {
   3.7159390325376177`*^9, 3.715939035111586*^9}, {3.71594359931763*^9, 
   3.715943626796852*^9}, 3.715943695482791*^9, {3.715960856192854*^9, 
   3.715960901898158*^9}, 3.7165651565028296`*^9, 3.7165715459328265`*^9},
 ExpressionUUID -> "f4683543-6951-44f2-858b-d2befbea63d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqinit", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"xCx", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"xCz", "[", "0", "]"}], "\[Equal]", " ", "h"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"xCx", "'"}], "[", "0", "]"}], "\[Equal]", "0.1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"xCz", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", 
      RowBox[{"Pi", "/", "4"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"-", "Pi"}], "/", "30"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.715938597687832*^9, 3.71593867311625*^9}, {
   3.715938847269896*^9, 3.715938867253024*^9}, {3.7159393383128033`*^9, 
   3.71593934572493*^9}, {3.715940056614675*^9, 3.715940056908928*^9}, {
   3.715943951315649*^9, 3.715943954851018*^9}, {3.7159442926640253`*^9, 
   3.715944325981077*^9}, 3.7159450304396772`*^9, {3.716609158414296*^9, 
   3.716609168240552*^9}},
 ExpressionUUID -> "db6bd72e-120d-4eb6-9d8b-cde1ddcba3a8"],

Cell[BoxData[
 RowBox[{"solpen", "=", 
  RowBox[{
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"eqNewton", ",", "eqEuler", ",", "eqinit"}], "}"}], "]"}], "/.",
       "data"}], ",", 
     RowBox[{"{", 
      RowBox[{"xCx", ",", "xCz", ",", "\[Theta]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "Tend"}], "}"}], ",", 
     RowBox[{"MaxStepFraction", "\[Rule]", 
      RowBox[{"1", "/", "10000"}]}], ",", 
     RowBox[{"MaxStepSize", "\[Rule]", "0.001"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.715938676508765*^9, 3.715938801000421*^9}, {
   3.7159388841412487`*^9, 3.7159389525235853`*^9}, {3.715938985708413*^9, 
   3.7159390058222713`*^9}, {3.715939067142861*^9, 3.715939072511532*^9}, {
   3.715939600246904*^9, 3.715939604154455*^9}, {3.7159397928622713`*^9, 
   3.715939798589588*^9}, {3.715939858093939*^9, 3.715939859323556*^9}, 
   3.715945043709893*^9, 3.7159581746646843`*^9, {3.715961230223723*^9, 
   3.715961237373711*^9}, 3.71596127243676*^9, {3.715961380650675*^9, 
   3.715961387272292*^9}, 3.715961624185652*^9, {3.715962078681817*^9, 
   3.715962107193726*^9}, {3.715962138376152*^9, 3.71596213920581*^9}},
 ExpressionUUID -> "d13373ce-a5ca-47f4-b0c2-b18056f72e1d"],

Cell[BoxData[
 RowBox[{"gC", "=", 
  RowBox[{"ParametricPlot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xC", "[", "t", "]"}], "/.", "solpen"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "Tend"}], "}"}], ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Gray", ",", "Dashed"}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "h"}], ",", 
         RowBox[{"6", "h"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"2", "h"}]}], "}"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.715961885520052*^9, 3.715961926268715*^9}, {
   3.715962146023514*^9, 3.715962146725418*^9}, {3.715963373964492*^9, 
   3.715963389401825*^9}, 3.7159635693106737`*^9, {3.7159636424449263`*^9, 
   3.7159636640105333`*^9}, {3.715965176554639*^9, 3.715965217617975*^9}, 
   3.7159652482232723`*^9, {3.7166318764614563`*^9, 3.7166318791217313`*^9}, {
   3.7166322572027683`*^9, 3.716632278194195*^9}},
 ExpressionUUID -> "9d5abc9f-b65b-4a89-8ea4-a3bdd85c6934"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{"gC", ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", "Large", "]"}], ",", 
           RowBox[{"Point", "[", 
            RowBox[{
             RowBox[{"xC", "[", "t", "]"}], "/.", "solpen"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Brown", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "3"}], "h"}], ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"6", "h"}], ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Blue", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xSr", "[", "t", "]"}], ")"}], "/.", "solpen"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xSf", "[", "t", "]"}], ")"}], "/.", "solpen"}]}], 
             "}"}], "]"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "h"}], ",", 
            RowBox[{"6", "h"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "h"}], ",", 
            RowBox[{"2", "h"}]}], "}"}]}], "}"}]}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "Tend", ",", "0.0001"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.715940548061445*^9, 3.715940590778699*^9}, 
   3.715940630861937*^9, 3.715940661723988*^9, {3.715940695786529*^9, 
   3.7159408576823263`*^9}, {3.715940931842057*^9, 3.715940964894903*^9}, {
   3.715941166394601*^9, 3.715941167920088*^9}, {3.715943898310112*^9, 
   3.715943900541492*^9}, {3.715944030074078*^9, 3.715944057920062*^9}, {
   3.715944215435789*^9, 3.715944215657568*^9}, {3.715944878603063*^9, 
   3.7159448792990513`*^9}, {3.715945083182498*^9, 3.715945083412277*^9}, {
   3.71594512135707*^9, 3.715945180561346*^9}, {3.715958221047715*^9, 
   3.715958240565105*^9}, {3.715958424921113*^9, 3.715958458743843*^9}, 
   3.715958605994672*^9, 3.7159590210769863`*^9, {3.715960702872178*^9, 
   3.715960704677887*^9}, {3.715960750126521*^9, 3.7159607504365683`*^9}, 
   3.715961677831662*^9, {3.715961730413909*^9, 3.71596173357174*^9}, {
   3.715961787716229*^9, 3.7159618149223347`*^9}, {3.715962155103993*^9, 
   3.7159621557735043`*^9}, {3.715962613700842*^9, 3.7159626542268353`*^9}, {
   3.7159628403589277`*^9, 3.71596288408212*^9}, {3.715963357261304*^9, 
   3.715963360203575*^9}, {3.715963403924212*^9, 3.715963508470787*^9}, 
   3.715964942596282*^9, {3.7159650561346693`*^9, 3.715965089549938*^9}, {
   3.71596511982901*^9, 3.71596513121131*^9}, {3.715965199586719*^9, 
   3.715965209602127*^9}, 3.715965240457065*^9, {3.716632292905501*^9, 
   3.7166323022960634`*^9}},
 ExpressionUUID -> "91a57617-a1d5-4081-beff-53623ebaf198"]
}, Open  ]]
},
WindowSize->{681, 676},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 274, 4, 201, "Title"],
Cell[857, 28, 196, 3, 37, "Input"],
Cell[1056, 33, 2374, 54, 134, "Input"],
Cell[3433, 89, 2802, 70, 278, "Input"],
Cell[6238, 161, 1772, 49, 134, "Input"],
Cell[8013, 212, 2963, 76, 206, "Input"],
Cell[10979, 290, 5031, 118, 326, "Input"],
Cell[16013, 410, 2047, 53, 158, "Input"],
Cell[18063, 465, 1176, 29, 62, "Input"],
Cell[19242, 496, 1332, 27, 110, "Input"],
Cell[20577, 525, 1200, 29, 86, "Input"],
Cell[21780, 556, 3392, 76, 206, "Input"]
}, Open  ]]
}
]
*)

